(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n;a=window;b=a.LoginPage=a.LoginPage||{};c=b.Client=b.Client||{};d=a.LoginPage_Templates=a.LoginPage_Templates||{};e=a.WebSharper;f=e&&e.UI;g=f&&f.Next;h=g&&g.Var;i=g&&g.Doc;j=e&&e.List;k=e&&e.Concurrency;l=e&&e.Remoting;m=l&&l.AjaxRemotingProvider;n=g&&g.View;c.Main=function(o){var p,q,r,s,t,u,v,w,x,y,z;p=h.Create$1("");q=h.Create$1("");r=o==null?(s=[i.TextNode("Login")],i.Element("h1",[],s)):(t=o.$0,(u=[i.TextNode("Welcome "+t+"!")],i.Element("h1",[],u)));v=o==null?d.login((w=(x=(y=j.T.Empty,new j.T({$:1,$0:{$:6,$0:"uname",$1:p},$1:y})),new j.T({$:1,$0:{$:6,$0:"password",$1:q},$1:x})),(z=function(A,B){return c.login(p,q,A,B);},new j.T({$:1,$0:{$:4,$0:"signin",$1:function(A){return function(B){return z(A,B);};}},$1:w})))):i.Button("Logout",[],function(){k.Start(k.Delay(function(){var A;A=(new m.New()).Async("LoginPage:LoginPage.Server.Logout:-829366048",[]);return k.Bind(A,function(){a.window.location.reload();return k.Return(null);});}),null);});return i.Concat([r,v]);};c.login=function(o,p,q,r){k.Start(k.Delay(function(){var s;s=n.GetAsync(o.RView());return k.Bind(s,function(t){var u;u=n.GetAsync(p.RView());return k.Bind(u,function(v){var w;w=(new m.New()).Async("LoginPage:LoginPage.Server.Login:380063967",[{Username:t,Password:v}]);return k.Bind(w,function(x){var y;y=(x!=null?x.$==1:false)?(a.alert("Succesfully logged in"),a.window.location.reload(),k.Return(null)):(a.alert("Invalid login data"),k.Return(null));return k.Combine(y,k.Delay(function(){return k.Return(null);}));});});});}),null);};d.login=function(o){var p,q;p={$:1,$0:"login"};q=function(){return a.jQuery.parseHTML("<div class=\"login-class\">\r\n    <div>Username: </div>\r\n    <input placeholder=\"required\" ws-var=\"UName\" type=\"text\">\r\n    <div>Password: </div>\r\n    <input type=\"password\" placeholder=\"required\" ws-var=\"Password\"><br>\r\n    <button class=\"login-btn\" ws-onclick=\"SignIn\">Sign in!</button>\r\n</div>");};return o?i.GetOrLoadTemplate("login",p,q,o):i.PrepareTemplate("login",p,q);};}());
