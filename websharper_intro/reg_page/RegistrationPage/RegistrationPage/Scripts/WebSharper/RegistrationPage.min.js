(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n;a=window;b=a.RegistrationPage=a.RegistrationPage||{};c=b.Client=b.Client||{};d=a.RegistrationPage_Templates=a.RegistrationPage_Templates||{};e=a.WebSharper;f=e&&e.UI;g=f&&f.Next;h=g&&g.Var;i=e&&e.List;j=g&&g.Doc;k=e&&e.Concurrency;l=e&&e.Remoting;m=l&&l.AjaxRemotingProvider;n=g&&g.View;c.RegPage=function(){var o,p,q,r,s,t,u,v,w,x;o=h.Create$1("");p=h.Create$1("");q=h.Create$1("");r=d.registration((s=(t=(u=(v=i.T.Empty,new i.T({$:1,$0:{$:6,$0:"uname",$1:o},$1:v})),new i.T({$:1,$0:{$:6,$0:"password1",$1:p},$1:u})),new i.T({$:1,$0:{$:6,$0:"password2",$1:q},$1:t})),(w=function(y,z){return c.Signup(o,p,q,y,z);},new i.T({$:1,$0:{$:4,$0:"signup",$1:function(y){return function(z){return w(y,z);};}},$1:s}))));return j.Concat([(x=[j.TextNode("Registration")],j.Element("h1",[],x)),r]);};c.Signup=function(o,p,q,r,s){};c.Main=function(o){var p,q,r,s,t,u,v,w,x,y,z;p=h.Create$1("");q=h.Create$1("");r=o==null?(s=[j.TextNode("Login")],j.Element("h1",[],s)):(t=o.$0,(u=[j.TextNode("Welcome "+t+"!")],j.Element("h1",[],u)));v=o==null?d.login((w=(x=(y=i.T.Empty,new i.T({$:1,$0:{$:6,$0:"uname",$1:p},$1:y})),new i.T({$:1,$0:{$:6,$0:"password",$1:q},$1:x})),(z=function(A,B){return c.login(p,q,A,B);},new i.T({$:1,$0:{$:4,$0:"signin",$1:function(A){return function(B){return z(A,B);};}},$1:w})))):j.Button("Logout",[],function(){k.Start(k.Delay(function(){var A;A=(new m.New()).Async("RegistrationPage:RegistrationPage.Server.Logout:-829366048",[]);return k.Bind(A,function(){a.window.location.reload();return k.Return(null);});}),null);});return j.Concat([r,v]);};c.login=function(o,p,q,r){k.Start(k.Delay(function(){var s;s=n.GetAsync(o.RView());return k.Bind(s,function(t){var u;u=n.GetAsync(p.RView());return k.Bind(u,function(v){var w;w=(new m.New()).Async("RegistrationPage:RegistrationPage.Server.Login:-667848513",[{Username:t,Password:v}]);return k.Bind(w,function(x){var y;y=(x!=null?x.$==1:false)?(a.alert("Succesfully logged in"),a.window.location.reload(),k.Return(null)):(a.alert("Invalid login data"),k.Return(null));return k.Combine(y,k.Delay(function(){return k.Return(null);}));});});});}),null);};d.login=function(o){var p,q;p={$:1,$0:"login"};q=function(){return a.jQuery.parseHTML("<div class=\"login-class\">\r\n    <div>Username: </div>\r\n    <input placeholder=\"required\" ws-var=\"UName\" type=\"text\">\r\n    <div>Password: </div>\r\n    <input type=\"password\" placeholder=\"required\" ws-var=\"Password\"><br>\r\n    <button class=\"login-btn\" ws-onclick=\"SignIn\">Sign in!</button>\r\n</div>");};return o?j.GetOrLoadTemplate("login",p,q,o):j.PrepareTemplate("login",p,q);};d.registration=function(o){var p,q;p={$:1,$0:"registration"};q=function(){return a.jQuery.parseHTML("<div class=\"reg-class\">\r\n    <div>Username</div>\r\n    <input placeholder=\"required\" ws-var=\"UName\" type=\"text\">\r\n    <div>Password: </div>\r\n    <input type=\"password\" placeholder=\"required\" ws-var=\"Password1\">\r\n    <div>Password Again: </div>\r\n    <input type=\"password\" placeholder=\"required\" ws-var=\"Password2\"><br>\r\n    <button class=\"login-btn\" ws-onclick=\"SignUp\">Sign up</button>\r\n</div>");};return o?j.GetOrLoadTemplate("registration",p,q,o):j.PrepareTemplate("registration",p,q);};}());
